# BareMetal F' project

This project was auto-generated by the F' utility tool. 

F´ (F Prime) is a component-driven framework that enables rapid development and deployment of spaceflight and other embedded software applications.
**Please Visit the F´ Website:** https://nasa.github.io/fprime/.


# Setup

### Install arduino-cli
```
$ curl -fsSL https://raw.githubusercontent.com/arduino/arduino-cli/master/install.sh | BINDIR=~/.local/bin sh

```

### Install arduino-cli-wrapper
```
$ cd ~/.local/bin
$ git clone https://github.com/SterlingPeet/arduino-cli-cmake-wrapper.git
$ cd arduino-cli-cmake-wrapper
$ git checkout update/refactor
$ pip install .
```

### Add `~/.local/bin` to PATH
```
$ sudo nano ~/.bashrc
```

At the end of the file, add the following line:
```
export PATH=~/.local/bin:$PATH
```

Save and close the file. Then run:
```
$ source ~/.bashrc
```

### Setup arduino-cli for Teensy boards
```
$ arduino-cli config init
$ sudo nano ~/.arduino15/arduino-cli.yaml
```

Add the following URL to the `board_manager` section:
```
board_manager:
  additional_urls:
    - https://www.pjrc.com/teensy/package_teensy_index.json
    - https://adafruit.github.io/arduino-board-index/package_adafruit_index.json
```

Download the new board package:
```
$ arduino-cli core update-index
$ arduino-cli core install teensy:avr
$ arduino-cli core install adafruit:samd
```

### Adding udev rules for Linux only
Add udev rules. Save the `.rules` files located in `./docs/rules` into `/etc/udev/rules.d/`.
```
$ sudo cp docs/rules/* /etc/udev/rules.d/
```

### Uploading binary for Feather M0
```
$ ~/.arduino15/packages/adafruit/tools/bossac/1.8.0-48-gb176eee/bossac -i -d --port=ttyACM0 -U -i --offset=0x2000 -w -v ./build-fprime-automatic-featherM0/bin/featherM0/BaremetalReference.bin -R
```
Note: If you have more than one device connected, `ttyACM0` may change.

### Using GDS over serial
```
$ fprime-gds -n --dictionary ./build-artifacts/YOUR_BUILD/BaremetalReference/dict/BaremetalReferenceTopologyAppDictionary.xml --comm-adapter uart --uart-device /dev/ttyACM0 --uart-baud 115200
```
Note: Change `YOUR BUILD` to either `teensy41` or `featherM0`. Also, if you have more than one device connected, `/dev/ttyACM0` may change.